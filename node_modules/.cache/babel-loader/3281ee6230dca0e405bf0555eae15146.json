{"remainingRequest":"/home/parallels/aws/test-amplify-album/amplify-vue-album/node_modules/babel-loader/lib/index.js!/home/parallels/aws/test-amplify-album/amplify-vue-album/node_modules/eslint-loader/index.js??ref--13-0!/home/parallels/aws/test-amplify-album/amplify-vue-album/src/router/index.js","dependencies":[{"path":"/home/parallels/aws/test-amplify-album/amplify-vue-album/src/router/index.js","mtime":1623474111539},{"path":"/home/parallels/aws/test-amplify-album/amplify-vue-album/node_modules/cache-loader/dist/cjs.js","mtime":1623474110567},{"path":"/home/parallels/aws/test-amplify-album/amplify-vue-album/node_modules/babel-loader/lib/index.js","mtime":1623474110571},{"path":"/home/parallels/aws/test-amplify-album/amplify-vue-album/node_modules/eslint-loader/index.js","mtime":1623474110379}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9ob21lL3BhcmFsbGVscy9hd3MvdGVzdC1hbXBsaWZ5LWFsYnVtL2FtcGxpZnktdnVlLWFsYnVtL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0IHsgY3JlYXRlUm91dGVyLCBjcmVhdGVXZWJIaXN0b3J5IH0gZnJvbSAndnVlLXJvdXRlcic7CmltcG9ydCBzdG9yZSBmcm9tICJAL3N0b3JlL2luZGV4LmpzIjsKaW1wb3J0IEF1dGggZnJvbSAiQGF3cy1hbXBsaWZ5L2F1dGgiOwppbXBvcnQgeyBBdXRoU3RhdGUsIG9uQXV0aFVJU3RhdGVDaGFuZ2UgfSBmcm9tICJAYXdzLWFtcGxpZnkvdWktY29tcG9uZW50cyI7CmltcG9ydCBTaWduSW4gZnJvbSAiLi4vdmlld3MvU2lnbkluLnZ1ZSI7CmltcG9ydCBBbGJ1bUluZGV4IGZyb20gIi4uL3ZpZXdzL2FsYnVtL0luZGV4LnZ1ZSI7CmltcG9ydCBBbGJ1bUNyZWF0ZSBmcm9tICIuLi92aWV3cy9hbGJ1bS9DcmVhdGUudnVlIjsKaW1wb3J0IEFsYnVtRWRpdCBmcm9tICIuLi92aWV3cy9hbGJ1bS9FZGl0LnZ1ZSI7CmltcG9ydCBBbGJ1bVNob3cgZnJvbSAiLi4vdmlld3MvYWxidW0vU2hvdy52dWUiOwppbXBvcnQgUGhvdG9DcmVhdGUgZnJvbSAiLi4vdmlld3MvcGhvdG8vQ3JlYXRlLnZ1ZSI7IC8vaW1wb3J0IEhvbWUgZnJvbSAnLi4vdmlld3MvSG9tZS52dWUnCgp2YXIgcm91dGVzID0gW3sKICBwYXRoOiAiLyIsCiAgcmVkaXJlY3Q6IHsKICAgIG5hbWU6ICJBbGJ1bUluZGV4IgogIH0KfSwgewogIHBhdGg6ICIvc2lnbmluIiwKICBuYW1lOiAiU2lnbkluIiwKICBjb21wb25lbnQ6IFNpZ25Jbgp9LCB7CiAgcGF0aDogIi9hbGJ1bXMiLAogIG5hbWU6ICJBbGJ1bUluZGV4IiwKICBjb21wb25lbnQ6IEFsYnVtSW5kZXgsCiAgbWV0YTogewogICAgcmVxdWlyZUF1dGg6IHRydWUKICB9Cn0sIHsKICBwYXRoOiAiL2FsYnVtcy9jcmVhdGUiLAogIG5hbWU6ICJBbGJ1bUNyZWF0ZSIsCiAgY29tcG9uZW50OiBBbGJ1bUNyZWF0ZSwKICBtZXRhOiB7CiAgICByZXF1aXJlQXV0aDogdHJ1ZQogIH0KfSwgewogIHBhdGg6ICIvYWxidW1zLzphbGJ1bUlkL2VkaXQiLAogIG5hbWU6ICJBbGJ1bUVkaXQiLAogIGNvbXBvbmVudDogQWxidW1FZGl0LAogIHByb3BzOiB0cnVlLAogIG1ldGE6IHsKICAgIHJlcXVpcmVBdXRoOiB0cnVlCiAgfQp9LCB7CiAgcGF0aDogIi9hbGJ1bXMvOmFsYnVtSWQiLAogIG5hbWU6ICJBbGJ1bVNob3ciLAogIGNvbXBvbmVudDogQWxidW1TaG93LAogIHByb3BzOiB0cnVlLAogIG1ldGE6IHsKICAgIHJlcXVpcmVBdXRoOiB0cnVlCiAgfQp9LCB7CiAgcGF0aDogIi9hbGJ1bXMvOmFsYnVtSWQvcGhvdG8vY3JlYXRlIiwKICBuYW1lOiAiUGhvdG9DcmVhdGUiLAogIGNvbXBvbmVudDogUGhvdG9DcmVhdGUsCiAgcHJvcHM6IHRydWUsCiAgbWV0YTogewogICAgcmVxdWlyZUF1dGg6IHRydWUKICB9Cn1dOwp2YXIgcm91dGVyID0gY3JlYXRlUm91dGVyKHsKICBoaXN0b3J5OiBjcmVhdGVXZWJIaXN0b3J5KHByb2Nlc3MuZW52LkJBU0VfVVJMKSwKICByb3V0ZXM6IHJvdXRlcwp9KTsKCmZ1bmN0aW9uIGdldEF1dGhlbnRpY2F0ZWRVc2VyKCkgewogIHJldHVybiBBdXRoLmN1cnJlbnRBdXRoZW50aWNhdGVkVXNlcigpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgIGlmIChkYXRhICYmIGRhdGEuc2lnbkluVXNlclNlc3Npb24pIHsKICAgICAgc3RvcmUuY29tbWl0KCJzZXRVc2VyIiwgZGF0YSk7CiAgICAgIHJldHVybiBkYXRhOwogICAgfQogIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICBjb25zb2xlLmVycm9yKGUpOwogICAgc3RvcmUuY29tbWl0KCJzZXRVc2VyIiwgbnVsbCk7CiAgICByZXR1cm4gbnVsbDsKICB9KTsKfQoKdmFyIHVzZXI7CnJvdXRlci5iZWZvcmVSZXNvbHZlKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKHRvLCBmcm9tLCBuZXh0KSB7CiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICByZXR1cm4gZ2V0QXV0aGVudGljYXRlZFVzZXIoKTsKCiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIHVzZXIgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgaWYgKCEodG8ubmFtZSA9PT0gIlNpZ25JbiIgJiYgdXNlcikpIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgbmV4dCh7CiAgICAgICAgICAgICAgbmFtZTogIkFsYnVtSW5kZXgiCiAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgIGlmICghKHRvLm1hdGNoZWQuc29tZShmdW5jdGlvbiAocmVjb3JkKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHJlY29yZC5tZXRhLnJlcXVpcmVBdXRoOwogICAgICAgICAgICB9KSAmJiAhdXNlcikpIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNzsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgbmV4dCh7CiAgICAgICAgICAgICAgbmFtZTogIlNpZ25JbiIKICAgICAgICAgICAgfSkpOwoKICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgbmV4dCgpKTsKCiAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZSk7CiAgfSkpOwoKICByZXR1cm4gZnVuY3Rpb24gKF94LCBfeDIsIF94MykgewogICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCkpOwpvbkF1dGhVSVN0YXRlQ2hhbmdlKGZ1bmN0aW9uIChhdXRoU3RhdGUsIGF1dGhEYXRhKSB7CiAgaWYgKGF1dGhTdGF0ZSA9PT0gQXV0aFN0YXRlLlNpZ25lZEluICYmIGF1dGhEYXRhKSB7CiAgICByb3V0ZXIucHVzaCh7CiAgICAgIG5hbWU6ICJBbGJ1bUluZGV4IgogICAgfSk7CiAgfQoKICBpZiAoYXV0aFN0YXRlID09PSBBdXRoU3RhdGUuU2lnbmVkT3V0KSB7CiAgICByb3V0ZXIucHVzaCh7CiAgICAgIG5hbWU6ICJTaWduSW4iCiAgICB9KTsKICB9Cn0pOwpleHBvcnQgZGVmYXVsdCByb3V0ZXI7"},{"version":3,"sources":["/home/parallels/aws/test-amplify-album/amplify-vue-album/src/router/index.js"],"names":["createRouter","createWebHistory","store","Auth","AuthState","onAuthUIStateChange","SignIn","AlbumIndex","AlbumCreate","AlbumEdit","AlbumShow","PhotoCreate","routes","path","redirect","name","component","meta","requireAuth","props","router","history","process","env","BASE_URL","getAuthenticatedUser","currentAuthenticatedUser","then","data","signInUserSession","commit","catch","e","console","error","user","beforeResolve","to","from","next","matched","some","record","authState","authData","SignedIn","push","SignedOut"],"mappings":"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","sourcesContent":["import { createRouter, createWebHistory } from 'vue-router'\nimport store from \"@/store/index.js\";\nimport Auth from \"@aws-amplify/auth\";\nimport { AuthState, onAuthUIStateChange } from \"@aws-amplify/ui-components\";\nimport SignIn from \"../views/SignIn.vue\";\nimport AlbumIndex from \"../views/album/Index.vue\";\nimport AlbumCreate from \"../views/album/Create.vue\";\nimport AlbumEdit from \"../views/album/Edit.vue\";\nimport AlbumShow from \"../views/album/Show.vue\";\nimport PhotoCreate from \"../views/photo/Create.vue\"\n\n//import Home from '../views/Home.vue'\n\nconst routes = [\n  {\n    path: \"/\",\n    redirect: { name: \"AlbumIndex\" },\n  },\n  {\n    path: \"/signin\",\n    name: \"SignIn\",\n    component: SignIn,\n  },\n  {\n    path: \"/albums\",\n    name: \"AlbumIndex\",\n    component: AlbumIndex,\n    meta: { requireAuth: true },\n  },\n  {\n    path: \"/albums/create\",\n    name: \"AlbumCreate\",\n    component: AlbumCreate,\n    meta: { requireAuth: true },\n  },\n  {\n    path: \"/albums/:albumId/edit\",\n    name: \"AlbumEdit\",\n    component: AlbumEdit,\n    props: true,\n    meta: { requireAuth: true },\n  },\n  {\n    path: \"/albums/:albumId\",\n    name: \"AlbumShow\",\n    component: AlbumShow,\n    props: true,\n    meta: { requireAuth: true },\n  },\n  {\n    path: \"/albums/:albumId/photo/create\",\n    name: \"PhotoCreate\",\n    component: PhotoCreate,\n    props: true,\n    meta: { requireAuth: true },\n  },\n];\n\nconst router = createRouter({\n  history: createWebHistory(process.env.BASE_URL),\n  routes\n})\n\nfunction getAuthenticatedUser() {\n  return Auth.currentAuthenticatedUser()\n    .then((data) => {\n      if (data && data.signInUserSession) {\n        store.commit(\"setUser\", data);\n        return data;\n      }\n    })\n    .catch((e) => {\n      console.error(e);\n      store.commit(\"setUser\", null);\n      return null;\n    });\n}\n\nlet user;\n\nrouter.beforeResolve(async (to, from, next) => {\n  //await getAuthenticatedUser();\n  user = await getAuthenticatedUser();\n\n  if (to.name === \"SignIn\" && user) {\n    return next({ name: \"AlbumIndex\" });\n  }\n\n  if (to.matched.some((record) => record.meta.requireAuth) && !user) {\n    return next({ name: \"SignIn\" });\n  }\n\n  return next();\n});\n\nonAuthUIStateChange((authState, authData) => {\n  if (authState === AuthState.SignedIn && authData) {\n    router.push({ name: \"AlbumIndex\" });\n  }\n  if (authState === AuthState.SignedOut) {\n    router.push({ name: \"SignIn\" });\n  }\n});\n\n\nexport default router\n"]}]}